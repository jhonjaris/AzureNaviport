<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ayuda - NaviPort RD</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <style>
        .help-container {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 30px;
            max-width: 1400px;
            margin: 30px auto;
            padding: 0 20px;
            min-height: calc(100vh - 140px);
        }

        /* Sidebar con √≠ndice */
        .help-sidebar {
            background: white;
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .help-sidebar h3 {
            font-size: 18px;
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid #3498db;
        }

        .help-index {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .help-index li {
            margin-bottom: 8px;
        }

        .help-index a {
            display: block;
            padding: 10px 12px;
            color: #555;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s;
            font-size: 14px;
        }

        .help-index a:hover {
            background: #f0f8ff;
            color: #3498db;
            padding-left: 16px;
        }

        .help-index a.active {
            background: #3498db;
            color: white;
            font-weight: 500;
        }

        .help-index .construction {
            color: #95a5a6;
            font-style: italic;
        }

        /* Contenido principal */
        .help-content {
            background: white;
            border-radius: 8px;
            padding: 35px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .help-header {
            margin-bottom: 30px;
        }

        .help-header h1 {
            font-size: 32px;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .help-header p {
            color: #7f8c8d;
            font-size: 16px;
        }

        /* B√∫squeda */
        .search-box {
            position: relative;
            margin-bottom: 30px;
        }

        .search-box input {
            width: 100%;
            padding: 14px 45px 14px 18px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 15px;
            transition: border-color 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: #3498db;
        }

        .search-box::after {
            content: "üîç";
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
        }

        .search-results {
            margin-top: 15px;
            padding: 12px;
            background: #fff3cd;
            border-radius: 6px;
            display: none;
        }

        .search-results.active {
            display: block;
        }

        /* Secciones de contenido */
        .help-section {
            margin-bottom: 40px;
            scroll-margin-top: 20px;
        }

        .help-section h2 {
            font-size: 24px;
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ecf0f1;
        }

        .help-section h3 {
            font-size: 20px;
            color: #34495e;
            margin-top: 25px;
            margin-bottom: 12px;
        }

        .help-section h4 {
            font-size: 16px;
            color: #555;
            margin-top: 18px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .help-section p {
            color: #555;
            line-height: 1.7;
            margin-bottom: 12px;
        }

        .help-section ul, .help-section ol {
            color: #555;
            line-height: 1.8;
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .help-section li {
            margin-bottom: 8px;
        }

        /* Alertas y notas */
        .help-note {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px 18px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .help-warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px 18px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .help-tip {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px 18px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .construction-badge {
            display: inline-block;
            background: #f39c12;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }

        /* Pasos numerados */
        .steps {
            counter-reset: step-counter;
            list-style: none;
            padding-left: 0;
        }

        .steps li {
            counter-increment: step-counter;
            margin-bottom: 20px;
            padding-left: 50px;
            position: relative;
        }

        .steps li::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            background: #3498db;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }

        /* Highlight para b√∫squeda */
        .highlight {
            background-color: #ffeb3b;
            padding: 2px 4px;
            border-radius: 2px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .help-container {
                grid-template-columns: 1fr;
            }

            .help-sidebar {
                position: static;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-brand">
            <span style="font-size: 28px; margin-right: 12px;">‚öì</span>
            <span style="font-size: 20px; font-weight: 600;">NaviPort RD</span>
        </div>
        <div class="navbar-menu">
            <a href="{% url 'accounts:dashboard' %}" class="navbar-item">
                üè† Volver al Dashboard
            </a>
            <div class="navbar-item dropdown">
                <span class="dropdown-toggle">üë§ {{ user.get_display_name }}</span>
                <div class="dropdown-menu">
                    <a href="{% url 'accounts:profile' %}">üë§ Mi Perfil</a>
                    <a href="{% url 'accounts:logout' %}">üö™ Cerrar Sesi√≥n</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="help-container">
        <!-- Sidebar con √≠ndice -->
        <aside class="help-sidebar">
            <h3>üìö √çndice</h3>
            <ul class="help-index">
                <li><a href="#introduccion" class="index-link">üè† Introducci√≥n</a></li>
                <li><a href="#requisitos" class="index-link">üíª Requisitos del Sistema</a></li>
                <li><a href="#primeros-pasos" class="index-link">üöÄ Primeros Pasos</a></li>

                {% if user_role == 'solicitante' %}
                <li><a href="#solicitante" class="index-link active">üë§ Gu√≠a del Solicitante</a></li>
                {% elif user_role == 'evaluador' %}
                <li><a href="#evaluador" class="index-link active">‚úÖ Gu√≠a del Evaluador</a></li>
                {% elif user_role == 'supervisor' %}
                <li><a href="#supervisor" class="index-link active">üë®‚Äçüíº Gu√≠a del Supervisor</a></li>
                {% elif user_role == 'oficial_acceso' %}
                <li><a href="#oficial" class="index-link active">üëÆ Gu√≠a del Oficial de Acceso</a></li>
                {% elif user_role == 'admin_tic' %}
                <li><a href="#admin" class="index-link active">‚öôÔ∏è Gu√≠a del Admin TIC</a></li>
                {% elif user_role == 'direccion' %}
                <li><a href="#direccion" class="index-link active construction">üìä Direcci√≥n (En construcci√≥n)</a></li>
                {% endif %}

                <li><a href="#faq" class="index-link">‚ùì Preguntas Frecuentes</a></li>
                <li><a href="#soporte" class="index-link">üìû Soporte T√©cnico</a></li>
            </ul>
        </aside>

        <!-- Contenido principal -->
        <main class="help-content">
            <div class="help-header">
                <h1>üìò Manual de Usuario</h1>
                <p>Bienvenido al manual de ayuda de NaviPort RD - Sistema de Gesti√≥n de Accesos Portuarios</p>
            </div>

            <!-- B√∫squeda -->
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Buscar en el manual...">
                <div id="searchResults" class="search-results"></div>
            </div>

            <!-- Introducci√≥n General -->
            <section id="introduccion" class="help-section">
                <h2>üè† Introducci√≥n</h2>
                <p>
                    <strong>NaviPort RD</strong> es el Sistema de Gesti√≥n de Accesos Portuarios de la Rep√∫blica Dominicana,
                    dise√±ado para facilitar y controlar el acceso de veh√≠culos y personal a las instalaciones portuarias.
                </p>
                <p>
                    Este sistema permite gestionar el flujo completo desde la solicitud de acceso hasta el control f√≠sico
                    mediante c√≥digos QR, garantizando seguridad, trazabilidad y eficiencia en todos los procesos.
                </p>
                <div class="help-note">
                    <strong>üìå Nota:</strong> Este manual est√° contextualizado para tu rol de <strong>{{ role_display }}</strong>.
                    Ver√°s informaci√≥n relevante a tus funciones espec√≠ficas.
                </div>
            </section>

            <!-- Requisitos del Sistema -->
            <section id="requisitos" class="help-section">
                <h2>üíª Requisitos del Sistema</h2>
                <h3>Navegadores Compatibles</h3>
                <ul>
                    <li>Google Chrome (versi√≥n 90 o superior) - Recomendado</li>
                    <li>Mozilla Firefox (versi√≥n 88 o superior)</li>
                    <li>Microsoft Edge (versi√≥n 90 o superior)</li>
                    <li>Safari (versi√≥n 14 o superior)</li>
                </ul>
                <h3>Requisitos M√≠nimos</h3>
                <ul>
                    <li>Conexi√≥n a Internet estable</li>
                    <li>Resoluci√≥n de pantalla m√≠nima: 1024x768</li>
                    <li>JavaScript habilitado</li>
                    <li>Cookies habilitadas</li>
                </ul>
                <div class="help-tip">
                    <strong>üí° Consejo:</strong> Para mejor experiencia, utilice Google Chrome en su versi√≥n m√°s reciente.
                </div>
            </section>

            <!-- Primeros Pasos -->
            <section id="primeros-pasos" class="help-section">
                <h2>üöÄ Primeros Pasos</h2>
                <h3>Acceso al Sistema</h3>
                <ol class="steps">
                    <li>
                        <strong>Ingrese a la p√°gina de inicio</strong><br>
                        Abra su navegador y acceda a la URL del sistema NaviPort RD
                    </li>
                    <li>
                        <strong>Introduzca sus credenciales</strong><br>
                        Ingrese su nombre de usuario y contrase√±a proporcionados por el administrador
                    </li>
                    <li>
                        <strong>Inicie sesi√≥n</strong><br>
                        Haga clic en el bot√≥n "üîê Iniciar Sesi√≥n"
                    </li>
                    <li>
                        <strong>Acceda a su dashboard</strong><br>
                        Ser√° redirigido autom√°ticamente a su panel de control seg√∫n su rol
                    </li>
                </ol>
                <div class="help-warning">
                    <strong>‚ö†Ô∏è Importante:</strong> Si olvida su contrase√±a, utilice el enlace "¬øOlvidaste tu contrase√±a?"
                    en la p√°gina de inicio de sesi√≥n para restablecerla.
                </div>
            </section>

            <!-- Contenido espec√≠fico por rol -->
            {% if user_role == 'solicitante' %}
            <section id="solicitante" class="help-section">
                <h2>üë§ Gu√≠a del Solicitante</h2>

                <h3>¬øQu√© es un Solicitante?</h3>
                <p>
                    Como <strong>Solicitante</strong>, usted representa a una empresa que requiere acceso a instalaciones
                    portuarias. Puede crear solicitudes de acceso, gestionar veh√≠culos y documentos, y dar seguimiento
                    a sus autorizaciones.
                </p>

                <h3>Crear una Nueva Solicitud</h3>
                <ol class="steps">
                    <li>
                        <strong>Acceda a "Nueva Solicitud"</strong><br>
                        Desde su dashboard, haga clic en el bot√≥n "‚ûï Nueva Solicitud"
                    </li>
                    <li>
                        <strong>Complete los datos de la solicitud</strong><br>
                        Ingrese el puerto de destino, motivo de acceso, fecha solicitada y descripci√≥n
                    </li>
                    <li>
                        <strong>Agregue veh√≠culos</strong><br>
                        Haga clic en "‚ûï Agregar Veh√≠culo" y complete: tipo, placa, marca, modelo, color y conductor
                    </li>
                    <li>
                        <strong>Adjunte documentos requeridos</strong><br>
                        Suba los documentos necesarios: licencia, marbete, seguro, c√©dula del conductor, etc.
                    </li>
                    <li>
                        <strong>Env√≠e la solicitud</strong><br>
                        Revise toda la informaci√≥n y haga clic en "üì§ Enviar Solicitud"
                    </li>
                </ol>

                <h3>Gesti√≥n de Veh√≠culos</h3>
                <h4>Agregar m√∫ltiples veh√≠culos</h4>
                <p>
                    Puede agregar varios veh√≠culos a una misma solicitud. Cada veh√≠culo debe tener su informaci√≥n completa
                    y documentos correspondientes.
                </p>
                <ul>
                    <li>Haga clic en "‚ûï Agregar Veh√≠culo" para a√±adir m√°s veh√≠culos</li>
                    <li>Use "üóëÔ∏è Eliminar" para remover un veh√≠culo antes de enviar</li>
                    <li>Verifique que todos los campos est√©n completos</li>
                </ul>

                <h3>Documentos Requeridos</h3>
                <h4>Tipos de documentos por veh√≠culo:</h4>
                <ul>
                    <li><strong>Licencia de Conducir:</strong> Del conductor asignado (formato PDF o imagen)</li>
                    <li><strong>Marbete:</strong> Vigente del veh√≠culo</li>
                    <li><strong>Seguro:</strong> P√≥liza vigente del veh√≠culo</li>
                    <li><strong>C√©dula:</strong> Del conductor</li>
                    <li><strong>Registro Veh√≠culo:</strong> Documentaci√≥n del veh√≠culo</li>
                </ul>
                <div class="help-note">
                    <strong>üìå Formatos aceptados:</strong> PDF, JPG, PNG (Tama√±o m√°ximo: 5MB por archivo)
                </div>

                <h3>Estados de Solicitudes</h3>
                <p>Sus solicitudes pueden tener los siguientes estados:</p>
                <ul>
                    <li><strong>üü° Pendiente:</strong> En espera de evaluaci√≥n</li>
                    <li><strong>üîµ En Revisi√≥n:</strong> Siendo evaluada por un oficial</li>
                    <li><strong>üü¢ Aprobada:</strong> Solicitud aprobada - se generar√° autorizaci√≥n autom√°ticamente</li>
                    <li><strong>üî¥ Rechazada:</strong> Solicitud denegada (ver comentarios del evaluador)</li>
                    <li><strong>üü† Documentos Solicitados:</strong> Se requieren documentos adicionales</li>
                    <li><strong>üü£ Escalada:</strong> Enviada a supervisor para revisi√≥n especial</li>
                </ul>

                <h3>Ver Autorizaciones Activas</h3>
                <p>
                    Una vez aprobada su solicitud, se genera autom√°ticamente una <strong>Autorizaci√≥n</strong> con c√≥digo QR.
                    Puede verla en la secci√≥n "Autorizaciones Activas".
                </p>
                <ol class="steps">
                    <li>Vaya a "Autorizaciones Activas" en el men√∫</li>
                    <li>Localice su autorizaci√≥n aprobada</li>
                    <li>Descargue o imprima el c√≥digo QR</li>
                    <li>Presente el c√≥digo QR al oficial de acceso en el puerto</li>
                </ol>

                <div class="help-tip">
                    <strong>üí° Consejo:</strong> Mantenga una copia digital del c√≥digo QR en su dispositivo m√≥vil
                    para facilitar el acceso.
                </div>
            </section>

            {% elif user_role == 'evaluador' %}
            <section id="evaluador" class="help-section">
                <h2>‚úÖ Gu√≠a del Evaluador</h2>

                <h3>¬øQu√© es un Evaluador?</h3>
                <p>
                    Como <strong>Evaluador</strong>, usted es responsable de revisar, aprobar o rechazar las solicitudes
                    de acceso portuario. Tambi√©n puede solicitar documentaci√≥n adicional o escalar casos complejos a supervisores.
                </p>

                <h3>Evaluar una Solicitud</h3>
                <ol class="steps">
                    <li>
                        <strong>Acceda a "Solicitudes Pendientes"</strong><br>
                        Desde su dashboard, vea la lista de solicitudes pendientes de evaluaci√≥n
                    </li>
                    <li>
                        <strong>Revise la solicitud</strong><br>
                        Haga clic en "Ver Detalles" para revisar toda la informaci√≥n
                    </li>
                    <li>
                        <strong>Verifique documentos</strong><br>
                        Revise que todos los documentos est√©n completos, vigentes y legibles
                    </li>
                    <li>
                        <strong>Tome una decisi√≥n</strong><br>
                        Elija entre: Aprobar, Rechazar, Solicitar Documentos o Escalar
                    </li>
                    <li>
                        <strong>Agregue comentarios</strong><br>
                        Proporcione observaciones o motivos de su decisi√≥n
                    </li>
                </ol>

                <h3>Acciones Disponibles</h3>

                <h4>‚úÖ Aprobar Solicitud</h4>
                <p>
                    Cuando todos los requisitos est√°n cumplidos:
                </p>
                <ul>
                    <li>Haga clic en "‚úÖ Aprobar"</li>
                    <li>Agregue comentarios si es necesario</li>
                    <li>Confirme la aprobaci√≥n</li>
                    <li>Se generar√° autom√°ticamente la autorizaci√≥n con c√≥digo QR</li>
                </ul>

                <h4>‚ùå Rechazar Solicitud</h4>
                <p>
                    Cuando la solicitud no cumple requisitos:
                </p>
                <ul>
                    <li>Haga clic en "‚ùå Rechazar"</li>
                    <li>Especifique el motivo del rechazo (obligatorio)</li>
                    <li>Confirme la acci√≥n</li>
                    <li>El solicitante ser√° notificado</li>
                </ul>

                <h4>üìÑ Solicitar Documentos</h4>
                <p>
                    Cuando faltan documentos o hay inconsistencias:
                </p>
                <ul>
                    <li>Haga clic en "üìÑ Solicitar Documentos"</li>
                    <li>Especifique qu√© documentos se requieren</li>
                    <li>La solicitud volver√° al solicitante</li>
                    <li>Recibir√° notificaci√≥n cuando se actualice</li>
                </ul>

                <h4>‚¨ÜÔ∏è Escalar a Supervisor</h4>
                <p>
                    Para casos que requieren autorizaci√≥n especial:
                </p>
                <ul>
                    <li>Haga clic en "‚¨ÜÔ∏è Escalar"</li>
                    <li>Explique el motivo de la escalaci√≥n</li>
                    <li>El supervisor revisar√° el caso</li>
                    <li>Recibir√° notificaci√≥n de la resoluci√≥n</li>
                </ul>

                <h3>Buenas Pr√°cticas</h3>
                <div class="help-tip">
                    <ul>
                        <li>Revise todas las secciones de la solicitud antes de decidir</li>
                        <li>Verifique la vigencia de documentos (licencias, seguros, marbetes)</li>
                        <li>Agregue comentarios claros y espec√≠ficos</li>
                        <li>Escale casos dudosos en lugar de rechazar directamente</li>
                        <li>Mantenga comunicaci√≥n profesional en los comentarios</li>
                    </ul>
                </div>

                <div class="help-warning">
                    <strong>‚ö†Ô∏è Importante:</strong> Una vez aprobada una solicitud, se genera autom√°ticamente
                    una autorizaci√≥n. Aseg√∫rese de verificar toda la informaci√≥n antes de aprobar.
                </div>
            </section>

            {% elif user_role == 'supervisor' %}
            <section id="supervisor" class="help-section">
                <h2>üë®‚Äçüíº Gu√≠a del Supervisor</h2>

                <h3>¬øQu√© es un Supervisor?</h3>
                <p>
                    Como <strong>Supervisor</strong>, usted gestiona casos escalados por evaluadores, resuelve discrepancias
                    reportadas por oficiales de acceso, y supervisa el funcionamiento general del sistema.
                </p>

                <h3>Gestionar Escalamientos</h3>
                <ol class="steps">
                    <li>
                        <strong>Revise escalamientos pendientes</strong><br>
                        En su dashboard, vea los casos escalados por evaluadores
                    </li>
                    <li>
                        <strong>Analice el caso</strong><br>
                        Revise la solicitud, documentos y comentarios del evaluador
                    </li>
                    <li>
                        <strong>Tome una decisi√≥n</strong><br>
                        Apruebe, rechace o devuelva al evaluador con instrucciones
                    </li>
                    <li>
                        <strong>Documente su decisi√≥n</strong><br>
                        Agregue comentarios explicando su resoluci√≥n
                    </li>
                </ol>

                <h3>Gestionar Discrepancias</h3>
                <p>
                    Los oficiales de acceso pueden reportar discrepancias cuando encuentran irregularidades al validar
                    autorizaciones en el punto de control.
                </p>
                <h4>Tipos de discrepancias comunes:</h4>
                <ul>
                    <li>Veh√≠culo no coincide con autorizaci√≥n</li>
                    <li>Conductor diferente al registrado</li>
                    <li>Documentos vencidos</li>
                    <li>C√≥digo QR no v√°lido o alterado</li>
                </ul>
                <ol class="steps">
                    <li>Revise el reporte de discrepancia</li>
                    <li>Verifique evidencias (fotos, comentarios)</li>
                    <li>Investigue el caso</li>
                    <li>Tome acci√≥n correctiva (suspender autorizaci√≥n, notificar empresa, etc.)</li>
                    <li>Cierre el caso con resoluci√≥n documentada</li>
                </ol>

                <h3>Supervisi√≥n y Reportes</h3>
                <p>Monitoree indicadores clave del sistema:</p>
                <ul>
                    <li>Cantidad de solicitudes por estado</li>
                    <li>Tiempo promedio de evaluaci√≥n</li>
                    <li>Tasa de aprobaci√≥n/rechazo</li>
                    <li>Escalamientos activos</li>
                    <li>Discrepancias reportadas</li>
                </ul>

                <div class="help-note">
                    <strong>üìå Nota:</strong> Su rol tiene autoridad para tomar decisiones finales en casos complejos.
                    Use este poder con responsabilidad y documentando siempre sus decisiones.
                </div>
            </section>

            {% elif user_role == 'oficial_acceso' %}
            <section id="oficial" class="help-section">
                <h2>üëÆ Gu√≠a del Oficial de Acceso</h2>

                <h3>¬øQu√© es un Oficial de Acceso?</h3>
                <p>
                    Como <strong>Oficial de Acceso</strong>, usted controla el acceso f√≠sico a las instalaciones portuarias
                    mediante la validaci√≥n de c√≥digos QR y autorizaciones. Es la √∫ltima l√≠nea de control de seguridad.
                </p>

                <h3>Validar Autorizaci√≥n con C√≥digo QR</h3>
                <ol class="steps">
                    <li>
                        <strong>Solicite el c√≥digo QR</strong><br>
                        Pida al conductor que presente su autorizaci√≥n con c√≥digo QR
                    </li>
                    <li>
                        <strong>Escanee el c√≥digo</strong><br>
                        Use la funci√≥n "üîç Escanear QR" en su dashboard o ingrese el c√≥digo manualmente
                    </li>
                    <li>
                        <strong>Verifique la informaci√≥n</strong><br>
                        El sistema mostrar√° los detalles de la autorizaci√≥n: empresa, veh√≠culo, conductor, vigencia
                    </li>
                    <li>
                        <strong>Valide f√≠sicamente</strong><br>
                        Compare la informaci√≥n en pantalla con:
                        <ul>
                            <li>Placa del veh√≠culo</li>
                            <li>Documentos del conductor</li>
                            <li>Fecha de vigencia</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Conceda o deniegue acceso</strong><br>
                        Si todo coincide: "‚úÖ Conceder Acceso"<br>
                        Si hay irregularidades: "‚ùå Denegar Acceso"
                    </li>
                </ol>

                <h3>Reportar Discrepancias</h3>
                <p>
                    Si encuentra irregularidades, debe reportarlas inmediatamente:
                </p>
                <ol class="steps">
                    <li>
                        <strong>Deniegue el acceso</strong><br>
                        Haga clic en "‚ùå Denegar Acceso"
                    </li>
                    <li>
                        <strong>Reporte la discrepancia</strong><br>
                        Haga clic en "‚ö†Ô∏è Reportar Discrepancia"
                    </li>
                    <li>
                        <strong>Especifique el tipo</strong><br>
                        Seleccione el tipo de irregularidad encontrada
                    </li>
                    <li>
                        <strong>Agregue detalles</strong><br>
                        Describa la situaci√≥n y adjunte evidencia si es posible
                    </li>
                    <li>
                        <strong>Env√≠e el reporte</strong><br>
                        El supervisor recibir√° notificaci√≥n inmediata
                    </li>
                </ol>

                <h3>Tipos de Irregularidades Comunes</h3>
                <ul>
                    <li><strong>Veh√≠culo no coincide:</strong> Placa, marca o modelo diferente</li>
                    <li><strong>Conductor no autorizado:</strong> Persona diferente a la registrada</li>
                    <li><strong>Documentos vencidos:</strong> Licencia, marbete o seguro expirados</li>
                    <li><strong>QR inv√°lido:</strong> C√≥digo no reconocido o alterado</li>
                    <li><strong>Autorizaci√≥n expirada:</strong> Fuera de fecha de vigencia</li>
                </ul>

                <h3>Registro de Accesos</h3>
                <p>
                    Cada validaci√≥n queda registrada autom√°ticamente con:
                </p>
                <ul>
                    <li>Fecha y hora exacta</li>
                    <li>Oficial que valid√≥</li>
                    <li>Punto de acceso</li>
                    <li>Resultado (concedido/denegado)</li>
                    <li>Observaciones</li>
                </ul>

                <div class="help-warning">
                    <strong>‚ö†Ô∏è Protocolo de Seguridad:</strong>
                    <ul>
                        <li>Nunca conceda acceso si hay dudas sobre la validez de la autorizaci√≥n</li>
                        <li>Verifique siempre los documentos f√≠sicos del conductor</li>
                        <li>Reporte cualquier intento de fraude o alteraci√≥n</li>
                        <li>En caso de duda, consulte con su supervisor antes de conceder acceso</li>
                    </ul>
                </div>
            </section>

            {% elif user_role == 'admin_tic' %}
            <section id="admin" class="help-section">
                <h2>‚öôÔ∏è Gu√≠a del Administrador TIC</h2>

                <h3>¬øQu√© es un Administrador TIC?</h3>
                <p>
                    Como <strong>Administrador TIC</strong>, usted tiene control total sobre el sistema NaviPort RD.
                    Gestiona usuarios, configuraciones, puertos, empresas y mantiene el funcionamiento general del sistema.
                </p>

                <h3>Gesti√≥n de Usuarios</h3>
                <h4>Crear nuevo usuario</h4>
                <ol class="steps">
                    <li>Acceda al panel de administraci√≥n de Django</li>
                    <li>Vaya a "Users" ‚Üí "Add User"</li>
                    <li>Complete los datos requeridos:
                        <ul>
                            <li>Nombre de usuario</li>
                            <li>Contrase√±a (m√≠nimo 8 caracteres)</li>
                            <li>Nombre completo</li>
                            <li>Email</li>
                            <li>C√©dula/RNC</li>
                            <li>Rol del usuario</li>
                            <li>Empresa (si aplica)</li>
                        </ul>
                    </li>
                    <li>Marque "Activo" para habilitar el usuario</li>
                    <li>Guarde los cambios</li>
                </ol>

                <h4>Roles disponibles en el sistema:</h4>
                <ul>
                    <li><strong>Solicitante:</strong> Representante de empresa que crea solicitudes</li>
                    <li><strong>Evaluador:</strong> Eval√∫a y aprueba/rechaza solicitudes</li>
                    <li><strong>Supervisor:</strong> Gestiona escalamientos y discrepancias</li>
                    <li><strong>Oficial de Acceso:</strong> Controla acceso f√≠sico con QR</li>
                    <li><strong>Admin TIC:</strong> Administrador del sistema</li>
                    <li><strong>Direcci√≥n:</strong> Visualizaci√≥n y reportes (en construcci√≥n)</li>
                </ul>

                <h3>Gesti√≥n de Empresas</h3>
                <ol class="steps">
                    <li>Acceda a "Empresas" en el panel de admin</li>
                    <li>Haga clic en "Add Empresa"</li>
                    <li>Complete:
                        <ul>
                            <li>Nombre de la empresa</li>
                            <li>RNC</li>
                            <li>Tel√©fono y email</li>
                            <li>Direcci√≥n</li>
                            <li>Tipo de empresa</li>
                        </ul>
                    </li>
                    <li>Marque "Activa" para habilitar</li>
                    <li>Asigne usuarios representantes</li>
                </ol>

                <h3>Configuraci√≥n de Puertos</h3>
                <p>Gestione los puertos disponibles en el sistema:</p>
                <ul>
                    <li>Agregue nuevos puertos con nombre, c√≥digo y ubicaci√≥n</li>
                    <li>Active/desactive puertos seg√∫n disponibilidad</li>
                    <li>Configure capacidades y restricciones</li>
                </ul>

                <h3>Motivos de Acceso</h3>
                <p>Configure los motivos de acceso disponibles para solicitudes:</p>
                <ul>
                    <li>Carga/Descarga</li>
                    <li>Mantenimiento</li>
                    <li>Inspecci√≥n</li>
                    <li>Supervisi√≥n</li>
                    <li>Servicios</li>
                    <li>Otros (personalizable)</li>
                </ul>

                <h3>Configuraci√≥n del Sistema</h3>
                <h4>Par√°metros configurables:</h4>
                <ul>
                    <li><strong>Vigencia de autorizaciones:</strong> D√≠as de validez por defecto</li>
                    <li><strong>Tama√±o m√°ximo de archivos:</strong> L√≠mite para documentos</li>
                    <li><strong>Tipos de documentos:</strong> Documentos requeridos por tipo de veh√≠culo</li>
                    <li><strong>Notificaciones:</strong> Configurar emails autom√°ticos</li>
                    <li><strong>Reportes:</strong> Configurar frecuencia y destinatarios</li>
                </ul>

                <h3>Mantenimiento</h3>
                <div class="help-tip">
                    <strong>üí° Tareas de mantenimiento recomendadas:</strong>
                    <ul>
                        <li>Revisar logs del sistema semanalmente</li>
                        <li>Limpiar autorizaciones expiradas mensualmente</li>
                        <li>Auditar usuarios inactivos</li>
                        <li>Verificar espacio de almacenamiento para documentos</li>
                        <li>Realizar respaldos peri√≥dicos de la base de datos</li>
                    </ul>
                </div>

                <h3>Soporte a Usuarios</h3>
                <p>Como administrador, tambi√©n es responsable del soporte t√©cnico:</p>
                <ul>
                    <li>Resetear contrase√±as de usuarios</li>
                    <li>Desbloquear cuentas bloqueadas</li>
                    <li>Resolver problemas de acceso</li>
                    <li>Asistir con errores del sistema</li>
                    <li>Capacitar nuevos usuarios</li>
                </ul>
            </section>

            {% elif user_role == 'direccion' %}
            <section id="direccion" class="help-section">
                <h2>üìä Direcci√≥n Log√≠stica <span class="construction-badge">EN CONSTRUCCI√ìN</span></h2>

                <div class="help-warning">
                    <strong>‚ö†Ô∏è M√≥dulo en Desarrollo</strong>
                    <p>
                        El m√≥dulo de Direcci√≥n Log√≠stica se encuentra actualmente en construcci√≥n.
                        Pr√≥ximamente contar√° con las siguientes funcionalidades:
                    </p>
                </div>

                <h3>Funcionalidades Planificadas</h3>
                <ul>
                    <li>üìä Dashboard ejecutivo con KPIs principales</li>
                    <li>üìà Reportes estad√≠sticos y gr√°ficas en tiempo real</li>
                    <li>üìâ An√°lisis de tendencias de solicitudes</li>
                    <li>üè¢ Reportes por empresa y puerto</li>
                    <li>‚è±Ô∏è Tiempos promedio de evaluaci√≥n y aprobaci√≥n</li>
                    <li>üìã Exportaci√≥n de reportes en Excel y PDF</li>
                    <li>üîî Alertas de incidencias y discrepancias</li>
                    <li>üë• Monitoreo de desempe√±o de evaluadores</li>
                </ul>

                <div class="help-note">
                    <strong>üìå Nota:</strong> Mientras tanto, puede acceder a reportes b√°sicos a trav√©s del
                    panel de administraci√≥n o contactar al Administrador TIC para solicitudes espec√≠ficas.
                </div>

                <h3>Acceso Temporal</h3>
                <p>
                    Actualmente puede consultar informaci√≥n b√°sica del sistema. Para reportes personalizados,
                    contacte al departamento de TIC.
                </p>
            </section>
            {% endif %}

            <!-- Preguntas Frecuentes -->
            <section id="faq" class="help-section">
                <h2>‚ùì Preguntas Frecuentes (FAQ)</h2>

                <h3>Preguntas Generales</h3>

                <h4>¬øQu√© hago si olvid√© mi contrase√±a?</h4>
                <p>
                    En la p√°gina de inicio de sesi√≥n, haga clic en "¬øOlvidaste tu contrase√±a?". Ingrese su correo
                    electr√≥nico registrado y recibir√° un enlace para restablecer su contrase√±a.
                </p>

                <h4>¬øPor qu√© mi cuenta est√° bloqueada?</h4>
                <p>
                    El sistema bloquea autom√°ticamente las cuentas despu√©s de 5 intentos fallidos de inicio de sesi√≥n
                    por seguridad. El bloqueo dura 30 minutos. Si necesita acceso inmediato, contacte al administrador.
                </p>

                <h4>¬øPuedo cambiar mi contrase√±a?</h4>
                <p>
                    S√≠. Acceda a "Mi Perfil" desde el men√∫ de usuario (esquina superior derecha) y seleccione
                    "Cambiar Contrase√±a". Necesitar√° su contrase√±a actual.
                </p>

                <h4>¬øCu√°nto tiempo es v√°lida una autorizaci√≥n?</h4>
                <p>
                    Las autorizaciones son v√°lidas seg√∫n la fecha especificada en la solicitud aprobada. Generalmente
                    entre 1 y 30 d√≠as. Verifique la vigencia en el c√≥digo QR generado.
                </p>

                <h3>Problemas T√©cnicos</h3>

                <h4>No puedo subir documentos</h4>
                <p>Verifique que:</p>
                <ul>
                    <li>El archivo sea PDF, JPG o PNG</li>
                    <li>El tama√±o no exceda 5MB</li>
                    <li>Su conexi√≥n a Internet sea estable</li>
                    <li>Su navegador permita la subida de archivos</li>
                </ul>

                <h4>El c√≥digo QR no se puede escanear</h4>
                <p>Intente:</p>
                <ul>
                    <li>Aumentar el brillo de la pantalla</li>
                    <li>Imprimir el c√≥digo en papel</li>
                    <li>Limpiar la c√°mara del dispositivo</li>
                    <li>Ingresar el c√≥digo manualmente</li>
                </ul>

                <h4>La p√°gina no carga correctamente</h4>
                <p>Soluciones comunes:</p>
                <ul>
                    <li>Actualice la p√°gina (F5 o Ctrl+F5)</li>
                    <li>Limpie el cach√© del navegador</li>
                    <li>Pruebe en otro navegador</li>
                    <li>Verifique su conexi√≥n a Internet</li>
                </ul>

                <h4>Error CSRF al iniciar sesi√≥n</h4>
                <p>Este error puede ocurrir si:</p>
                <ul>
                    <li>Las cookies est√°n deshabilitadas en su navegador</li>
                    <li>Tiene varias pesta√±as de login abiertas</li>
                    <li>La p√°gina qued√≥ cacheada por mucho tiempo</li>
                </ul>
                <p><strong>Soluci√≥n:</strong> Refresque la p√°gina (Ctrl+F5) y vuelva a intentar.</p>
            </section>

            <!-- Soporte T√©cnico -->
            <section id="soporte" class="help-section">
                <h2>üìû Soporte T√©cnico</h2>

                <h3>Canales de Soporte</h3>

                <div class="help-note">
                    <strong>üìß Email:</strong> soporte@naviportrd.com<br>
                    <strong>üì± Tel√©fono:</strong> +1 (809) 555-0100<br>
                    <strong>‚è∞ Horario:</strong> Lunes a Viernes, 8:00 AM - 5:00 PM<br>
                    <strong>üè¢ Ubicaci√≥n:</strong> Autoridad Portuaria Dominicana, Santo Domingo
                </div>

                <h3>Antes de Contactar Soporte</h3>
                <p>Para agilizar su solicitud, tenga a mano:</p>
                <ul>
                    <li>Su nombre de usuario</li>
                    <li>Descripci√≥n del problema</li>
                    <li>Capturas de pantalla del error (si aplica)</li>
                    <li>Navegador y versi√≥n que est√° usando</li>
                    <li>Pasos que realiz√≥ antes del error</li>
                </ul>

                <h3>Tiempo de Respuesta</h3>
                <ul>
                    <li><strong>Urgente:</strong> 2 horas</li>
                    <li><strong>Alta:</strong> 4 horas</li>
                    <li><strong>Normal:</strong> 24 horas</li>
                    <li><strong>Baja:</strong> 48 horas</li>
                </ul>

                <div class="help-tip">
                    <strong>üí° Consejo:</strong> Antes de contactar soporte, revise este manual y la secci√≥n de
                    Preguntas Frecuentes. Muchas dudas comunes ya est√°n respondidas.
                </div>
            </section>
        </main>
    </div>

    <script>
        // Navegaci√≥n suave al hacer clic en el √≠ndice
        document.querySelectorAll('.index-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetSection = document.querySelector(targetId);

                if (targetSection) {
                    targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

                    // Actualizar link activo
                    document.querySelectorAll('.index-link').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                }
            });
        });

        // Funcionalidad de b√∫squeda
        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');
        const sections = document.querySelectorAll('.help-section');

        searchInput.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase().trim();

            // Limpiar highlights anteriores
            sections.forEach(section => {
                const content = section.innerHTML;
                section.innerHTML = content.replace(/<span class="highlight">(.*?)<\/span>/g, '$1');
            });

            if (searchTerm.length < 3) {
                searchResults.classList.remove('active');
                searchResults.innerHTML = '';
                return;
            }

            let resultsCount = 0;
            let resultsHTML = '<strong>Resultados de b√∫squeda:</strong><br>';

            sections.forEach(section => {
                const sectionText = section.textContent.toLowerCase();
                if (sectionText.includes(searchTerm)) {
                    resultsCount++;
                    const sectionTitle = section.querySelector('h2').textContent;
                    const sectionId = section.id;
                    resultsHTML += `<a href="#${sectionId}" style="display: block; margin: 5px 0; color: #3498db;">üìÑ ${sectionTitle}</a>`;

                    // Highlight en el contenido
                    const regex = new RegExp(`(${searchTerm})`, 'gi');
                    section.innerHTML = section.innerHTML.replace(regex, '<span class="highlight">$1</span>');
                }
            });

            if (resultsCount > 0) {
                searchResults.innerHTML = resultsHTML;
                searchResults.classList.add('active');
            } else {
                searchResults.innerHTML = '<strong>No se encontraron resultados para:</strong> "' + searchTerm + '"';
                searchResults.classList.add('active');
            }
        });

        // Detectar secci√≥n visible al hacer scroll
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.3
        };

        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.id;
                    const correspondingLink = document.querySelector(`.index-link[href="#${id}"]`);

                    if (correspondingLink) {
                        document.querySelectorAll('.index-link').forEach(link => {
                            link.classList.remove('active');
                        });
                        correspondingLink.classList.add('active');
                    }
                }
            });
        }, observerOptions);

        sections.forEach(section => observer.observe(section));
    </script>
</body>
</html>
